{% extends "base.html" %}

{% block main_content %}
<div class="container mt-4">
    {% if party %}
        <h1>{{party.name}}</h1>

        <h2>Party Details</h2>
        <p><strong>Goal:</strong> {{ party.party_goal }} problems</p>
        <p><strong>Start:</strong> {{ party.party_start }}</p>
        <p><strong>End:</strong> {{ party.party_end }}</p>

        <hr>

        <h3>Current Members</h3>
        <ul>
            {% for member in members %}
                <li>
                    {{ member.lc_username }}
                    {% if member.pid != session['pid'] %}
                        <form style="display:inline" method="POST" action="{{ url_for('remove_member', cpid=party.cpid) }}">
                            <input type="hidden" name="pid" value="{{ member.pid }}">
                            <button type="submit">Remove</button>
                        </form>
                    {% else %}
                        (You)
                    {% endif %}
                </li>
            {% endfor %}
        </ul>

        <hr>

        <h3>Invite Connections</h3>
        <form method="POST" action="{{ url_for('add_member', cpid=party.cpid) }}">
            {% if connections %}
                {% for user in connections %}
                    {% if user.in_party %}
                        <label style="color:gray;">{{ user.lc_username }} (Already in this party)</label><br>
                    {% else %}
                        <input type="checkbox" name="pid" value="{{ user.pid }}">
                        <label>{{ user.lc_username }}</label><br>
                    {% endif %}
                {% endfor %}
                <button type="submit">Add Selected Members</button>
            {% else %}
                <p>No connections available to invite.</p>
            {% endif %}
        </form>

    {% else %}
        <h2>You are not in any party yet.</h2>
        <a href="{{ url_for('create_party') }}" class="btn btn-primary mt-3">Create a Party</a>
    {% endif %}
</div>
{% endblock %}
